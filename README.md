# GPT-4-ENEM

This repository contains code and data used in the paper "Evaluating GPT-3.5 and GPT-4 Models on Brazilian University Admission Exams". The study explores the capabilities of Language Models (LMs) in solving high-stakes multiple-choice tests, using the *Exame Nacional do Ensino MÃ©dio (ENEM)* as a case study. The ENEM is a multidisciplinary entrance examination widely adopted by Brazilian universities, which poses challenging tasks for LMs since its questions may span multiple fields of knowledge, requiring understanding of information from diverse domains.

The paper analyzes responses generated by GPT-3.5 and GPT-4 models for questions presented in the 2009-2017 exams, as well as for questions of the 2022 exam, which were made public after the training of the models completed. Furthermore, different prompt strategies were tested, including the use of Chain-of-Thought (CoT) prompts to generate explanations to answers.

On the 2022 edition, the best-performing model, GPT-4 with CoT, achieved an accuracy of 87%, largely surpassing GPT-3.5 by 11 points.

## Reproducing the results
To reproduce the experiments described in the paper, please follow the steps below:

### 1. Clone the repository:
```bash
git clone https://github.com/piresramon/gpt-4-enem.git
```

### 2. Install the required packages:
```bash
pip install -r requirements.txt
```
### 3. Set the OPENAI API key:
```bash
...
```
### 4. Run the experiments:
```bash
# running 3-shot with CoT for chatgpt
python main.py \
    --model chatgpt \
    --model_args engine=gpt-3.5-turbo \
    --task enem_cot_2022 \
    --num_fewshot 3 \
    --description_dict_path description.json

# running 3-shot with CoT for gpt-4
python main.py \
    --model chatgpt \
    --model_args engine=gpt-4-0314 \
    --task enem_cot_2022 \
    --num_fewshot 3 \
    --description_dict_path description.json
```


## Citation
If you use this code or data in your research, please cite the following paper:

```bibtex
@misc{nunes2023evaluating,
      title={Evaluating GPT-3.5 and GPT-4 Models on Brazilian University Admission Exams}, 
      author={Desnes Nunes and Ricardo Primi and Ramon Pires and Roberto Lotufo and Rodrigo Nogueira},
      year={2023},
      eprint={2303.17003},
      archivePrefix={arXiv},
      primaryClass={cs.CL}
}
```

## Contact
If you have any questions or comments, please feel free to contact us at pires.ramon@gmail.com.